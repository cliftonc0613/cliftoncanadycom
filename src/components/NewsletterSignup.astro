---
interface Props {
  title?: string;
  description?: string;
  ctaText?: string;
}

const {
  title = "Get Weekly AI Insights",
  description = "Join 500+ professionals receiving actionable tips on AI, WordPress, and digital strategy delivered to your inbox every Friday.",
  ctaText = "Subscribe"
} = Astro.props;
---

<section class="py-12 md:py-16 px-4">
  <div class="max-w-2xl mx-auto">
    <div class="relative bg-gradient-to-br from-primary/10 via-white to-accent/5 border border-primary/20 rounded-lg shadow-lg overflow-hidden">
      <!-- Decorative accent -->
      <div class="absolute -top-20 -right-20 w-40 h-40 bg-gradient-to-br from-accent/30 to-transparent rounded-full blur-3xl"></div>
      <div class="absolute -bottom-20 -left-20 w-40 h-40 bg-gradient-to-tr from-primary/20 to-transparent rounded-full blur-3xl"></div>

      <div class="relative z-10 p-8 md:p-12">
        <!-- Heading -->
        <div class="mb-6">
          <h3 class="text-3xl md:text-4xl font-bold font-[Poppins] text-foreground mb-3">
            {title}
          </h3>
          <p class="text-gray-600 text-base md:text-lg leading-relaxed">
            {description}
          </p>
        </div>

        <!-- Form -->
        <form id="newsletter-form" class="space-y-4">
          <!-- Name Field -->
          <div class="relative">
            <input
              type="text"
              id="newsletter-name"
              placeholder="Your Name"
              required
              class="w-full px-5 py-3 bg-white border-2 border-gray-200 rounded-lg font-[Roboto_Mono] text-foreground placeholder-gray-400 focus:outline-none focus:border-primary transition-colors duration-200"
            />
            <span class="absolute right-4 top-3 text-gray-300">
              <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
              </svg>
            </span>
          </div>

          <!-- Email Field -->
          <div class="relative">
            <input
              type="email"
              id="newsletter-email"
              placeholder="your@email.com"
              required
              class="w-full px-5 py-3 bg-white border-2 border-gray-200 rounded-lg font-[Roboto_Mono] text-foreground placeholder-gray-400 focus:outline-none focus:border-primary transition-colors duration-200"
            />
            <span class="absolute right-4 top-3 text-gray-300">
              <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
              </svg>
            </span>
          </div>

          <!-- Error Message (hidden by default) -->
          <div id="newsletter-error" class="hidden text-red-600 text-sm font-[Roboto_Mono] px-4 py-2 bg-red-50 border border-red-200 rounded-lg">
            Please check your email and try again
          </div>

          <!-- Success Message (hidden by default) -->
          <div id="newsletter-success" class="hidden text-green-700 text-sm font-[Roboto_Mono] px-4 py-2 bg-green-50 border border-green-200 rounded-lg">
            Thank you for subscribing! Check your email to confirm.
          </div>

          <!-- Submit Button -->
          <button
            type="submit"
            id="newsletter-btn"
            class="w-full py-3 px-6 bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary text-white font-bold font-[Poppins] rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center justify-center gap-2"
          >
            <span>{ctaText}</span>
            <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
            </svg>
          </button>

          <!-- Privacy notice -->
          <p class="text-xs text-gray-500 text-center font-[Roboto_Mono]">
            We respect your privacy. Unsubscribe at any time.
          </p>
        </form>
      </div>
    </div>
  </div>
</section>

<script define:vars={{ ctaText }}>
  // Handle form submission
  const form = document.getElementById('newsletter-form');
  const nameInput = document.getElementById('newsletter-name');
  const emailInput = document.getElementById('newsletter-email');
  const submitBtn = document.getElementById('newsletter-btn');
  const errorMsg = document.getElementById('newsletter-error');
  const successMsg = document.getElementById('newsletter-success');

  if (form) {
    form.addEventListener('submit', (e) => {
      e.preventDefault();

      // Reset messages
      errorMsg.classList.add('hidden');
      successMsg.classList.add('hidden');

      // Validate name
      if (!nameInput.value.trim()) {
        errorMsg.textContent = 'Please enter your name';
        errorMsg.classList.remove('hidden');
        return;
      }

      // Validate email format
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(emailInput.value)) {
        errorMsg.textContent = 'Please enter a valid email address';
        errorMsg.classList.remove('hidden');
        return;
      }

      // Show success message (v1 placeholder - no actual submission)
      successMsg.classList.remove('hidden');
      submitBtn.textContent = 'Subscribed!';
      submitBtn.disabled = true;

      // Reset form
      form.reset();

      // Re-enable button after 3 seconds
      setTimeout(() => {
        submitBtn.textContent = ctaText;
        submitBtn.disabled = false;
        successMsg.classList.add('hidden');
      }, 3000);
    });
  }
</script>
